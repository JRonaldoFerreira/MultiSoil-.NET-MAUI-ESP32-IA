<?xml version="1.0" encoding="UTF-8" ?>
<?xaml-comp compile="true" ?>
<ContentPage x:Class="MultiSoil_EdgeAI.Views.TalhoesPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             Title="Talhões">

    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Adicionar"
                     Priority="0"
                     Clicked="OnAddClicked" />
    </ContentPage.ToolbarItems>

    <VerticalStackLayout Padding="16" Spacing="12">

        <CollectionView x:Name="ListView"
                        SelectionMode="Single"
                        SelectionChanged="OnSelectionChanged"
                        ItemsLayout="VerticalList">

            <CollectionView.EmptyView>
                <Label Text="Nenhum talhão cadastrado."
                       HorizontalOptions="Center"
                       VerticalOptions="Center"
                       Style="{StaticResource Hint}" />
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <SwipeView>

                        <SwipeView.RightItems>
                            <SwipeItems Mode="Execute">
                                <SwipeItem Text="Editar"
                                           Invoked="OnEditSwipe"
                                           BackgroundColor="{toolkit:AppThemeResource PrimaryColor}" />
                                <SwipeItem Text="Excluir"
                                           Invoked="OnDeleteSwipe"
                                           BackgroundColor="{AppThemeBinding Light=#EF4444, Dark=#F87171}" />
                            </SwipeItems>
                        </SwipeView.RightItems>

                        <Border Style="{StaticResource CardBorder}">
                            <Grid Padding="12"
                                  ColumnSpacing="12"
                                  RowSpacing="4"
                                  ColumnDefinitions="*,Auto"
                                  RowDefinitions="Auto,Auto">

                                <!-- ESQUERDA: Nome + Cultura -->
                                <VerticalStackLayout Grid.Row="0"
                                                     Grid.Column="0"
                                                     Grid.RowSpan="2"
                                                     Spacing="2">

                                    <Label Text="{Binding Nome}"
                                           FontAttributes="Bold"
                                           FontSize="16" />

                                    <Label Text="{Binding Cultura}"
                                           FontSize="13"
                                           Opacity="0.8" />
                                </VerticalStackLayout>

                                <!-- DIREITA: Microcontrolador e Servidor em chips separados -->
                                <VerticalStackLayout Grid.Row="0"
                                                     Grid.Column="1"
                                                     Grid.RowSpan="2"
                                                     Spacing="6"
                                                     HorizontalOptions="End"
                                                     VerticalOptions="Center">

                                    <!-- Chip do Microcontrolador -->
                                    <Border Padding="6,2"
                                            StrokeThickness="0"
                                            BackgroundColor="{AppThemeBinding Light=#FFE3F2FD, Dark=#FF102A43}">
                                        <HorizontalStackLayout Spacing="4">
                                            <Label Text="MCU"
                                                   FontSize="11"
                                                   FontAttributes="Bold"
                                                   Opacity="0.8" />
                                            <Label Text="{Binding Microcontrolador}"
                                                   FontSize="11"
                                                   Opacity="0.8" />
                                        </HorizontalStackLayout>
                                    </Border>

                                    <!-- Chip do Servidor (URL) -->
                                    <Border Padding="6,2"
                                            StrokeThickness="0"
                                            BackgroundColor="{AppThemeBinding Light=#FFF1F8E9, Dark=#FF1B2A12}">
                                        <HorizontalStackLayout Spacing="4">
                                            <Label Text="Servidor"
                                                   FontSize="11"
                                                   FontAttributes="Bold"
                                                   Opacity="0.8" />
                                            <Label Text="{Binding ServidorUrl}"
                                                   FontSize="11"
                                                   LineBreakMode="TailTruncation"
                                                   MaxLines="1"
                                                   Opacity="0.8" />
                                        </HorizontalStackLayout>
                                    </Border>

                                </VerticalStackLayout>
                            </Grid>
                        </Border>

                    </SwipeView>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </VerticalStackLayout>
</ContentPage>
